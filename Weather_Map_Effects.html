<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Weather Map Effects</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
      body {
        margin: 0;
        background: #111;
        font-family: Arial, sans-serif;
      }

      /* MAP SECTION */
      .map-section {
        position: relative;
        width: 100%;
        height: 450px;
        overflow: hidden;
      }

      /* MAP */
      .map-section iframe {
        width: 100%;
        height: 100%;
        border: none;
        filter: brightness(0.85);
      }

      /* RAIN CANVAS */
      #rain {
        position: absolute;
        inset: 0;
        pointer-events: none;
      }

      /* FOG OVERLAY */
      .map-section::after {
        content: "";
        position: absolute;
        inset: 0;
        background: url("https://i.imgur.com/QZ7X9Vf.png");
        opacity: 0.25;
        animation: fogMove 60s linear infinite;
        pointer-events: none;
      }

      @keyframes fogMove {
        from {
          background-position: 0 0;
        }
        to {
          background-position: 1000px 0;
        }
      }

      /* LIGHTNING */
      .lightning {
        position: absolute;
        inset: 0;
        background: white;
        opacity: 0;
        pointer-events: none;
        animation: flash 10s infinite;
      }

      @keyframes flash {
        0%,
        94%,
        100% {
          opacity: 0;
        }
        95% {
          opacity: 0.8;
        }
        96% {
          opacity: 0;
        }
        97% {
          opacity: 0.5;
        }
        98% {
          opacity: 0;
        }
      }
    </style>
  </head>

  <body>
    <div class="map-section">
      <!-- GOOGLE MAP -->
      <iframe src="https://www.google.com/maps?q=Patna,Bihar&z=11&output=embed">
      </iframe>

      <!-- EFFECT LAYERS -->
      <canvas id="rain"></canvas>
      <div class="lightning"></div>

      <!-- THUNDER SOUND -->
      <audio
        id="thunder"
        src="https://www.soundjay.com/nature/thunder-1.mp3"
      ></audio>
    </div>

    <script>
      /* ===== RAIN EFFECT ===== */
      const canvas = document.getElementById("rain");
      const ctx = canvas.getContext("2d");

      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = document.querySelector(".map-section").offsetHeight;
      }
      resizeCanvas();
      window.addEventListener("resize", resizeCanvas);

      let drops = [];
      for (let i = 0; i < 180; i++) {
        drops.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          l: Math.random() * 20 + 10,
          s: Math.random() * 4 + 2,
        });
      }

      function rain() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.strokeStyle = "rgba(255,255,255,0.5)";
        ctx.lineWidth = 1;

        drops.forEach((d) => {
          ctx.beginPath();
          ctx.moveTo(d.x, d.y);
          ctx.lineTo(d.x, d.y + d.l);
          ctx.stroke();

          d.y += d.s;
          if (d.y > canvas.height) {
            d.y = -20;
            d.x = Math.random() * canvas.width;
          }
        });

        requestAnimationFrame(rain);
      }
      rain();

      /* ===== THUNDER SOUND RANDOM ===== */
      setInterval(
        () => {
          const thunder = document.getElementById("thunder");
          thunder.volume = 0.5;
          thunder.currentTime = 0;
          thunder.play();
        },
        12000 + Math.random() * 8000,
      );
    </script>
  </body>
</html>
