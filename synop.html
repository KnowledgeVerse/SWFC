<!doctype html>
<html lang="hi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IMD SYNOP Decoder - ‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§Æ‡•å‡§∏‡§Æ ‡§µ‡§ø‡§≠‡§æ‡§ó</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+Devanagari:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <style>
      body {
        font-family: "Inter", "Noto Sans Devanagari", sans-serif;
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        min-height: 100vh;
      }
      .glass-panel {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .station-card {
        background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
        border-left: 4px solid #3b82f6;
        transition: all 0.3s ease;
      }
      .station-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
      }
      .param-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
      }
      .param-item {
        background: rgba(59, 130, 246, 0.1);
        border-radius: 0.5rem;
        padding: 0.75rem;
        border: 1px solid rgba(59, 130, 246, 0.2);
      }
      .param-label {
        font-size: 0.75rem;
        color: #94a3b8;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      .param-value {
        font-size: 1.125rem;
        font-weight: 600;
        color: #f8fafc;
        margin-top: 0.25rem;
      }
      .code-badge {
        font-family: "Courier New", monospace;
        background: #0f172a;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.875rem;
        color: #60a5fa;
      }
      .summary-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.875rem;
      }
      .summary-table th {
        background: rgba(59, 130, 246, 0.2);
        color: #60a5fa;
        padding: 0.75rem;
        text-align: left;
        font-weight: 600;
        border-bottom: 2px solid rgba(59, 130, 246, 0.3);
        position: sticky;
        top: 0;
      }
      .summary-table td {
        padding: 0.75rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        color: #e2e8f0;
      }
      .summary-table tr:hover {
        background: rgba(255, 255, 255, 0.05);
      }
      .rh-highlight {
        background: rgba(34, 197, 94, 0.2);
        color: #4ade80;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-weight: 600;
      }
      .wb-highlight {
        background: rgba(251, 146, 60, 0.2);
        color: #fb923c;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-weight: 600;
      }
      .vis-highlight {
        background: rgba(168, 85, 247, 0.2);
        color: #c084fc;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-weight: 600;
      }
      .gmt-badge {
        background: linear-gradient(135deg, #3b82f6, #8b5cf6);
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 600;
      }
      .date-badge {
        background: rgba(34, 197, 94, 0.2);
        color: #4ade80;
        padding: 0.25rem 0.75rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 600;
        border: 1px solid rgba(34, 197, 94, 0.3);
      }
      .month-badge {
        background: rgba(251, 146, 60, 0.2);
        color: #fb923c;
        padding: 0.25rem 0.75rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 600;
        border: 1px solid rgba(251, 146, 60, 0.3);
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .animate-fade-in {
        animation: fadeIn 0.5s ease-out forwards;
      }
      .progress-bar {
        width: 100%;
        height: 4px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 2px;
        overflow: hidden;
        margin: 10px 0;
      }
      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        transition: width 0.3s ease;
      }
      .batch-indicator {
        background: rgba(59, 130, 246, 0.2);
        border: 1px solid rgba(59, 130, 246, 0.3);
        border-radius: 0.5rem;
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
        color: #60a5fa;
      }
    </style>
  </head>
  <body class="text-slate-200 p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
      <!-- Navigation Bar -->
      <div
        class="glass-panel rounded-xl p-3 mb-8 flex flex-wrap justify-center gap-2"
      >
        <a
          href="index.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Home"
          ><i class="fas fa-home"></i
        ></a>
        <a
          href="live.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Live Preview"
          ><i class="fas fa-tower-broadcast"></i
        ></a>
        <a
          href="temp.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Live Temp"
          ><i class="fas fa-thermometer-half"></i
        ></a>
        <a
          href="wind.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Wind"
          ><i class="fas fa-wind"></i
        ></a>
        <a
          href="rain.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Rain"
          ><i class="fas fa-cloud-showers-heavy"></i
        ></a>
        <a
          href="humidity.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Humidity"
          ><i class="fas fa-tint"></i
        ></a>
        <a
          href="display.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Display Mode"
          ><i class="fas fa-tv"></i
        ></a>
        <div class="w-px h-10 bg-slate-700 mx-1"></div>
        <a
          href="bulletin.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Weather Bulletin"
          ><i class="fas fa-clipboard-list"></i
        ></a>
        <a
          href="Generate_Weather_Bulletin.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Generate Bulletin"
          ><i class="fas fa-file-lines"></i
        ></a>
        <a
          href="max_min_rh.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Observed Data"
          ><i class="fas fa-table"></i
        ></a>
        <a
          href="Weather_summary.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Weather Summary"
          ><i class="fas fa-file-alt"></i
        ></a>
        <a
          href="Detailed_Weather_Forecast.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Detailed Forecast"
          ><i class="fas fa-list-alt"></i
        ></a>
        <a
          href="Weather_Warning_Table.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Warning Table"
          ><i class="fas fa-table"></i
        ></a>
        <a
          href="bulk_import.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Import Data"
          ><i class="fas fa-file-import"></i
        ></a>
        <a
          href="Temperature_Forecast.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Min/Max Temp"
          ><i class="fas fa-temperature-high"></i
        ></a>
        <a
          href="forecast.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="7-Day Forecast"
          ><i class="fas fa-calendar-day"></i
        ></a>
        <a
          href="warning.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="7-Day Warning"
          ><i class="fas fa-exclamation-triangle"></i
        ></a>
        <a
          href="bulletin_footer.html"
          class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-all border border-slate-700 w-10 h-10 flex items-center justify-center"
          title="Bulletin Footer"
          ><i class="fas fa-file-signature"></i
        ></a>
        <a
          href="synop.html"
          class="p-2 rounded-lg bg-blue-600 text-white border border-blue-500 w-10 h-10 flex items-center justify-center"
          title="SYNOP Decoder"
          ><i class="fas fa-code"></i
        ></a>
      </div>

      <!-- Header -->
      <div class="text-center mb-8">
        <h1
          class="text-4xl md:text-5xl font-bold mb-2 bg-gradient-to-r from-blue-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent"
        >
          IMD SYNOP Decoder
        </h1>
        <p class="text-slate-400 text-lg">
          ‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§Æ‡•å‡§∏‡§Æ ‡§µ‡§ø‡§≠‡§æ‡§ó - ‡§∏‡§§‡§π ‡§Æ‡•å‡§∏‡§Æ ‡§Ö‡§µ‡§≤‡•ã‡§ï‡§® ‡§°‡§ø‡§ï‡•ã‡§°‡§∞
        </p>
        <p class="text-slate-500 text-sm mt-2">
          Supports up to 30,000+ lines | Auto Month Detection | Batch Processing
        </p>
      </div>

      <!-- Input Section -->
      <div class="glass-panel rounded-2xl p-6 mb-8">
        <div class="flex flex-col md:flex-row gap-4 mb-4">
          <div class="flex-1">
            <label class="block text-sm font-medium text-slate-300 mb-2"
              >SYNOP Data Paste ‡§ï‡§∞‡•á‡§Ç (Any GMT: 00, 03, 06, 09, 12, 15, 18, 21 |
              Supports 30,000+ lines)</label
            >
            <textarea
              id="synopInput"
              rows="10"
              class="w-full bg-slate-900 border border-slate-700 rounded-lg p-4 text-slate-300 font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
              placeholder="‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡§æ SYNOP ‡§°‡•á‡§ü‡§æ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç...&#10;Month markers: JUL: AUG: SEP: OCT: NOV: DEC: JAN: FEB: MAR: APR: MAY: JUN:&#10;Example:&#10;SMIN90 VEPT 191200&#10;AAXX 19124&#10;42492 31996 40000 10266 20130 40140 70500 84030 333 10292 58022 84360=rh=043/18.6Vis=4500m"
            ></textarea>
            <div class="progress-bar hidden" id="progressBar">
              <div
                class="progress-fill"
                id="progressFill"
                style="width: 0%"
              ></div>
            </div>
            <div
              id="processingStatus"
              class="text-sm text-slate-400 mt-2 hidden"
            ></div>
          </div>
        </div>
        <div class="flex flex-wrap gap-3">
          <button
            onclick="decodeAndStoreSynop()"
            class="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-semibold py-3 px-8 rounded-lg transition-all transform hover:scale-105 shadow-lg shadow-blue-500/30"
          >
            Decode & Store ‡§ï‡§∞‡•á‡§Ç
          </button>
          <button
            onclick="clearAll()"
            class="bg-slate-700 hover:bg-slate-600 text-white font-semibold py-3 px-6 rounded-lg transition-all"
          >
            Clear
          </button>
          <button
            onclick="loadExample()"
            class="bg-purple-600 hover:bg-purple-500 text-white font-semibold py-3 px-6 rounded-lg transition-all"
          >
            Example Load ‡§ï‡§∞‡•á‡§Ç
          </button>
          <button
            onclick="showDatabaseView()"
            class="bg-green-600 hover:bg-green-500 text-white font-semibold py-3 px-6 rounded-lg transition-all"
          >
            <i class="fas fa-database mr-2"></i>Database View
          </button>
          <button
            onclick="exportDatabase()"
            class="bg-amber-600 hover:bg-amber-500 text-white font-semibold py-3 px-6 rounded-lg transition-all"
          >
            <i class="fas fa-download mr-2"></i>Export JSON
          </button>
        </div>
      </div>

      <!-- Database View Section (Hidden by default) -->
      <div id="databaseView" class="hidden mb-8">
        <div class="glass-panel rounded-2xl p-6 mb-6">
          <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
            <i class="fas fa-database text-green-400"></i>
            Stored SYNOP Database
          </h2>

          <!-- Date Selection -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div>
              <label class="block text-sm font-medium text-slate-300 mb-2"
                >Select Date (DD-MM-YYYY)</label
              >
              <input
                type="text"
                id="selectDate"
                placeholder="19-07-2024"
                class="bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white w-full"
              />
              <p class="text-xs text-slate-500 mt-1">Format: DD-MM-YYYY</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-slate-300 mb-2"
                >Select GMT</label
              >
              <select
                id="selectGMT"
                class="bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white w-full"
              >
                <option value="all">All GMT</option>
                <option value="00">00 GMT</option>
                <option value="03">03 GMT</option>
                <option value="06">06 GMT</option>
                <option value="09">09 GMT</option>
                <option value="12">12 GMT</option>
                <option value="15">15 GMT</option>
                <option value="18">18 GMT</option>
                <option value="21">21 GMT</option>
              </select>
            </div>
            <div class="flex items-end">
              <button
                onclick="loadDateData()"
                class="bg-blue-600 hover:bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg transition-all w-full"
              >
                Load Data
              </button>
            </div>
          </div>

          <!-- Available Dates List -->
          <div class="mb-6">
            <h3 class="text-lg font-semibold text-white mb-3">
              Available Dates in Database:
            </h3>
            <div
              id="availableDatesList"
              class="flex flex-wrap gap-2 max-h-32 overflow-y-auto p-2 bg-slate-900 rounded-lg"
            >
              <!-- Dates will be loaded here -->
            </div>
          </div>

          <!-- Date Range Selection -->
          <div class="glass-panel rounded-xl p-4 mb-6 border border-slate-700">
            <h3 class="text-lg font-semibold text-white mb-3">
              Date Range Comparison
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label class="block text-xs text-slate-400 mb-1"
                  >From Date (DD-MM-YYYY)</label
                >
                <input
                  type="text"
                  id="fromDate"
                  placeholder="01-07-2024"
                  class="bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 text-white w-full text-sm"
                />
              </div>
              <div>
                <label class="block text-xs text-slate-400 mb-1"
                  >To Date (DD-MM-YYYY)</label
                >
                <input
                  type="text"
                  id="toDate"
                  placeholder="31-07-2024"
                  class="bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 text-white w-full text-sm"
                />
              </div>
              <div class="flex items-end">
                <button
                  onclick="compareDates()"
                  class="bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-2 px-4 rounded-lg transition-all w-full text-sm"
                >
                  Compare Dates
                </button>
              </div>
            </div>
          </div>

          <!-- 03 & 12 GMT Special Table Button -->
          <button
            onclick="show0312Table()"
            class="mb-4 bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-500 hover:to-orange-500 text-white font-semibold py-2 px-4 rounded-lg transition-all"
          >
            <i class="fas fa-table mr-2"></i>Show 03 & 12 GMT Special Table
          </button>

          <!-- Stored Data Display -->
          <div id="storedDataDisplay" class="space-y-6">
            <!-- Data will be loaded here -->
          </div>
        </div>
      </div>

      <!-- 03 & 12 GMT Special Table (Hidden by default) -->
      <div id="special0312Table" class="hidden mb-8">
        <div class="glass-panel rounded-2xl p-6 border-2 border-amber-500/50">
          <h2
            class="text-xl font-bold text-white mb-4 flex items-center gap-2 text-amber-400"
          >
            <i class="fas fa-star"></i>
            03 & 12 GMT Special Summary Table
          </h2>
          <div class="overflow-x-auto max-h-96 overflow-y-auto">
            <table class="summary-table" id="table0312">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>GMT</th>
                  <th>Station</th>
                  <th>Temp (¬∞C)</th>
                  <th>Max Temp (¬∞C)</th>
                  <th>WB (¬∞C)</th>
                  <th>RH (%)</th>
                  <th>Pressure (hPa)</th>
                  <th>Visibility (m)</th>
                  <th>Wind</th>
                  <th>Weather</th>
                </tr>
              </thead>
              <tbody id="tbody0312"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Current Decode Results -->
      <div id="currentResults">
        <!-- Date/Time Info -->
        <div
          id="dateTimeInfo"
          class="hidden mb-6 glass-panel rounded-xl p-4 border-l-4 border-cyan-500"
        >
          <div class="flex items-center justify-between flex-wrap gap-4">
            <div>
              <span class="text-slate-400 text-sm"
                >Observation Date & Time</span
              >
              <div class="flex items-center gap-3 mt-1 flex-wrap">
                <span class="month-badge" id="monthDisplay">--</span>
                <span class="date-badge" id="obsDateDisplay">--</span>
                <span class="gmt-badge" id="obsTimeDisplay">-- GMT</span>
              </div>
            </div>
            <div class="flex gap-6 text-sm flex-wrap">
              <div>
                <span class="text-slate-500">Report Type:</span>
                <span class="text-white font-semibold ml-2"
                  >AAXX (Land Station)</span
                >
              </div>
              <div>
                <span class="text-slate-500">Wind Unit:</span>
                <span
                  id="windUnit"
                  class="text-white font-semibold ml-2"
                ></span>
              </div>
              <div>
                <span class="text-slate-500">Total Stations:</span>
                <span id="totalStations" class="text-white font-semibold ml-2"
                  >0</span
                >
              </div>
              <div>
                <span class="text-slate-500">Batches:</span>
                <span id="batchCount" class="text-white font-semibold ml-2"
                  >0</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Summary Table -->
        <div
          id="summarySection"
          class="hidden mb-8 glass-panel rounded-xl p-6 overflow-hidden"
        >
          <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
            <span class="w-2 h-2 bg-green-400 rounded-full"></span>
            GMT Summary Table - ‡§∏‡§≠‡•Ä ‡§∏‡•ç‡§ü‡•á‡§∂‡§® ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£
          </h2>
          <div class="overflow-x-auto max-h-96 overflow-y-auto">
            <table class="summary-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>GMT</th>
                  <th>Station ID</th>
                  <th>Station Name</th>
                  <th>Temp (¬∞C)</th>
                  <th>Wet Bulb (¬∞C)</th>
                  <th>RH (%)</th>
                  <th>Visibility (m)</th>
                  <th>Wind (Dir/Speed)</th>
                  <th>Weather</th>
                  <th>Cloud</th>
                </tr>
              </thead>
              <tbody id="summaryTableBody"></tbody>
            </table>
          </div>
        </div>

        <!-- Results Container -->
        <div id="resultsContainer" class="space-y-6">
          <!-- Stations will be inserted here -->
        </div>
      </div>

      <!-- Empty State -->
      <div id="emptyState" class="text-center py-20">
        <div class="text-6xl mb-4">üå§Ô∏è</div>
        <h3 class="text-xl font-semibold text-slate-400">
          SYNOP Data ‡§ï‡§æ ‡§á‡§Ç‡§§‡§ú‡§æ‡§∞ ‡§π‡•à
        </h3>
        <p class="text-slate-500 mt-2">
          ‡§ä‡§™‡§∞ ‡§¶‡§ø‡§è ‡§ó‡§è ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡§æ ‡§°‡•á‡§ü‡§æ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ Decode ‡§ï‡§∞‡•á‡§Ç
        </p>
        <p class="text-slate-600 text-sm mt-1">
          Supports: JUL: AUG: SEP: OCT: NOV: DEC: JAN: FEB: MAR: APR: MAY: JUN:
          markers
        </p>
      </div>

      <!-- Footer -->
      <footer class="mt-16 pt-8 border-t border-slate-700/50 text-center">
        <div class="space-y-2 mb-6">
          <p class="text-slate-400 text-sm">
            ‡§°‡•á‡§ü‡§æ ‡§∏‡•ç‡§∞‡•ã‡§§: India Meteorological Department (IMD), Meteorological
            Centre, Patna.
          </p>
          <p class="text-slate-400 text-sm">
            ‡§¨‡§ø‡§π‡§æ‡§∞ ‡§Æ‡•å‡§∏‡§Æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§® ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä: ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§è‡§µ‡§Ç ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡•Å‡§§‡•Ä‡§ï‡§∞‡§£
          </p>
        </div>

        <div class="mb-2">
          <span class="text-2xl font-extrabold text-[#ff9966]"
            >@ Lal Kamal</span
          >
        </div>
        <p class="text-slate-500 text-sm">All Rights Reserved.</p>
      </footer>
    </div>

    <script>
      // Initialize database from localStorage
      let synopDatabase =
        JSON.parse(localStorage.getItem("synopDatabase")) || {};

      // Month mapping
      const monthMap = {
        JAN: "01",
        FEB: "02",
        MAR: "03",
        APR: "04",
        MAY: "05",
        JUN: "06",
        JUL: "07",
        AUG: "08",
        SEP: "09",
        OCT: "10",
        NOV: "11",
        DEC: "12",
      };

      // Current month tracker
      let currentMonth = String(new Date().getMonth() + 1).padStart(2, "0");
      let currentYear = new Date().getFullYear();

      // Updated Station Names Mapping
      const stationNames = {
        42492: "Patna",
        42591: "Gaya",
        42498: "Bhagalpur",
        42500: "Purnea",
        42283: "Valmiki Nagar",
        42395: "Forbesganj",
        42588: "Dehri",
        42383: "Motihari",
        42393: "Supaul",
        42391: "Darbhanga",
        42488: "Chapra",
        42387: "Muzaffarpur",
        42499: "Sabour",
      };

      // Code Tables based on PDF
      const codeTables = {
        windDir: {
          "00": "Calm",
          "02": "NNE",
          "05": "NE",
          "07": "ENE",
          "09": "E",
          11: "ESE",
          14: "SE",
          16: "SSE",
          18: "S",
          20: "SSW",
          23: "SW",
          25: "WSW",
          27: "W",
          29: "WNW",
          32: "NW",
          34: "NNW",
          36: "N",
          99: "Var",
        },
        cloudAmount: {
          0: "0/8",
          1: "1/8",
          2: "2/8",
          3: "3/8",
          4: "4/8",
          5: "5/8",
          6: "6/8",
          7: "7/8",
          8: "8/8",
          9: "Obsc",
        },
        presentWeather: {
          "00": "Clear",
          "01": "Clouds‚Üì",
          "02": "Same",
          "03": "Clouds‚Üë",
          "05": "Haze",
          10: "Mist",
          50: "Drizzle",
          60: "Rain",
          61: "Rain Mod",
          62: "Rain Hvy",
          70: "Snow",
          80: "Showers",
          95: "T-Storm",
        },
      };

      function loadExample() {
        const example = `SMIN90 VEPT 191200
AAXX 19124
42492 31996 40000 10266 20130 40140 70500 84030 333 10292 58022 84360=rh=043/18.6Vis=4500m
42591 31596 43604 10250 20170 40147 70510 82540 333 10290 58020 82620 83360= WB=20.0 RH=061% VIS=5000M
42498 31595 40000 10266 20138 40147 70521 82530 333 10291 58018 82620 84360= 19.0/rh=045% Vis.=3500m
42500 31595 30000 10270 20182 40129 70520 83500 333 10306 58014 83620= WB=21.4 RH=059%, VIS=3200m
42283 32596 30000 10246 20193 40113 82530 333 10300 58018= WB 21.2 RH=072% PK

AUG:
SMIN90 VEPT 201200
AAXX 20124
42492 31996 40000 10270 20135 40145 70500 84030 333 10295 58020=rh=048/19.0Vis=4000m
42591 31596 43604 10255 20175 40150 70510 82540 333 10295 58018= WB=20.5 RH=065% VIS=4500M`;
        document.getElementById("synopInput").value = example;
      }

      function clearAll() {
        document.getElementById("synopInput").value = "";
        document.getElementById("resultsContainer").innerHTML = "";
        document.getElementById("summarySection").classList.add("hidden");
        document.getElementById("dateTimeInfo").classList.add("hidden");
        document.getElementById("emptyState").classList.remove("hidden");
        document.getElementById("databaseView").classList.add("hidden");
        document.getElementById("currentResults").classList.remove("hidden");
        document.getElementById("progressBar").classList.add("hidden");
        document.getElementById("processingStatus").classList.add("hidden");
      }

      // Smart RH, WB, and Visibility Parser
      function parseCommentData(comment) {
        const result = {
          rh: null,
          wb: null,
          visibility: null,
          minVisibility: null,
        };

        if (!comment) return result;

        // Extract WB - number before / or after WB/W.B/WB=
        const wbMatch =
          comment.match(/(?:W\.?B\.?\s*[=:]?\s*|^)(\d+\.?\d*)\s*(?:\/|;)/i) ||
          comment.match(/W\.?B\.?\s*[=:]?\s*(\d+\.?\d*)/i);
        if (wbMatch) {
          result.wb = parseFloat(wbMatch[1]);
        }

        // Extract RH - various patterns
        const rhPatterns = [
          /RH\s*[=:]?\s*(\d{2,3})\s*%?/i,
          /\/(\d{2,3})\s*%/,
          /^(\d{2,3})\s*%/,
          /rh\s*[=:]?\s*(\d{2,3})/i,
        ];

        for (let pattern of rhPatterns) {
          const match = comment.match(pattern);
          if (match) {
            const val = parseInt(match[1]);
            if (val >= 0 && val <= 100) {
              result.rh = val;
              break;
            }
          }
        }

        // Extract Visibility
        const visPatterns = [
          /VIS\s*[=:]?\s*(\d{3,5})/i,
          /Vis\.?\s*[=:]?\s*(\d{3,5})/i,
          /\/(\d{4})(?:\/|%|$)/,
          /Vis\.?\s*(\d{3,5})/i,
        ];

        for (let pattern of visPatterns) {
          const match = comment.match(pattern);
          if (match) {
            const val = parseInt(match[1]);
            if (val >= 100 && val <= 50000) {
              result.visibility = val;
              break;
            }
          }
        }

        // Min visibility
        const minMatch = comment.match(/min\s*[=:]?\s*(\d{3,5})/i);
        if (minMatch) {
          result.minVisibility = parseInt(minMatch[1]);
        }

        return result;
      }

      // Decode Pressure from 4PPPP format
      function decodePressure(pressCode) {
        if (!pressCode || pressCode.length !== 5) return null;

        const digits = pressCode.substring(1);
        const firstDigit = digits[0];
        const value = parseInt(digits);

        // If starts with 0 or 1, it's 1000+ hPa
        if (firstDigit === "0" || firstDigit === "1") {
          return (1000 + value / 10).toFixed(1);
        } else {
          // If starts with 8 or 9, it's 800-999 hPa (less than 1000)
          return (value / 10).toFixed(1);
        }
      }

      async function decodeAndStoreSynop() {
        const input = document.getElementById("synopInput").value.trim();
        if (!input) {
          alert("‡§ï‡•É‡§™‡§Ø‡§æ SYNOP ‡§°‡•á‡§ü‡§æ ‡§°‡§æ‡§≤‡•á‡§Ç!");
          return;
        }

        // Show progress
        const progressBar = document.getElementById("progressBar");
        const progressFill = document.getElementById("progressFill");
        const statusDiv = document.getElementById("processingStatus");

        progressBar.classList.remove("hidden");
        statusDiv.classList.remove("hidden");

        const lines = input.split("\n");
        const totalLines = lines.length;

        statusDiv.textContent = `Processing ${totalLines} lines...`;

        // Process in chunks for large files
        const chunkSize = 1000;
        let processedLines = 0;
        let allBatches = [];
        let currentBatch = {
          header: null,
          stations: [],
          month: currentMonth,
          year: currentYear,
        };

        // Reset month to current
        currentMonth = String(new Date().getMonth() + 1).padStart(2, "0");
        currentYear = new Date().getFullYear();

        for (let i = 0; i < lines.length; i++) {
          const line = lines[i].trim();
          processedLines++;

          // Update progress every 100 lines
          if (processedLines % 100 === 0) {
            const progress = (processedLines / totalLines) * 100;
            progressFill.style.width = `${progress}%`;
            statusDiv.textContent = `Processing... ${processedLines}/${totalLines} lines (${Math.round(progress)}%)`;
            await new Promise((resolve) => setTimeout(resolve, 0)); // Allow UI update
          }

          if (!line) continue;

          // Check for month marker
          const monthMatch = line.match(
            /^(JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC):?/i,
          );
          if (monthMatch) {
            // Save previous batch if exists
            if (currentBatch.header && currentBatch.stations.length > 0) {
              allBatches.push({ ...currentBatch });
            }

            // Reset for new month
            currentMonth = monthMap[monthMatch[1].toUpperCase()];
            currentBatch = {
              header: null,
              stations: [],
              month: currentMonth,
              year: currentYear,
            };
            continue;
          }

          // Check for header line (SMIN...)
          if (line.startsWith("SMIN")) {
            // Save previous batch if exists
            if (currentBatch.header && currentBatch.stations.length > 0) {
              allBatches.push({ ...currentBatch });
              currentBatch.stations = [];
            }

            currentBatch.header = {
              bulletin: line.substring(0, 6),
              region: line.substring(6, 10),
              dateTime: line.substring(10, 16),
            };
            continue;
          }

          // Check for AAXX line
          if (line.startsWith("AAXX")) {
            const parts = line.split(" ");
            if (currentBatch.header) {
              currentBatch.header.reportType = parts[0];
              currentBatch.header.obsDate = parts[1]
                ? parts[1].substring(0, 2)
                : "";
              currentBatch.header.obsHour = parts[1]
                ? parts[1].substring(2, 4)
                : "";
              currentBatch.header.windIndicator = parts[1]
                ? parts[1].substring(4, 5)
                : "";
            }
            continue;
          }

          // Check for station data
          const stationMatch = line.match(/^(\d{5})\s+/);
          if (stationMatch && currentBatch.header) {
            const station = parseStationLine(line);
            if (station) {
              station.month = currentBatch.month;
              station.year = currentBatch.year;
              currentBatch.stations.push(station);
            }
          }
        }

        // Add last batch
        if (currentBatch.header && currentBatch.stations.length > 0) {
          allBatches.push(currentBatch);
        }

        progressFill.style.width = "100%";
        statusDiv.textContent = `Processing complete! Found ${allBatches.length} batches. Storing...`;

        // Store all batches
        let totalStored = 0;
        allBatches.forEach((batch, idx) => {
          const dateKey = `${batch.header.obsDate}-${batch.month}-${batch.year}`;
          const gmtKey = batch.header.obsHour;

          if (!synopDatabase[dateKey]) {
            synopDatabase[dateKey] = {};
          }

          synopDatabase[dateKey][gmtKey] = {
            header: batch.header,
            stations: batch.stations,
            timestamp: new Date().toISOString(),
          };

          totalStored += batch.stations.length;
        });

        // Save to localStorage
        localStorage.setItem("synopDatabase", JSON.stringify(synopDatabase));

        // Display first batch
        if (allBatches.length > 0) {
          const firstBatch = allBatches[0];
          displayBatch(firstBatch);

          // Show summary for all batches
          if (allBatches.length > 1) {
            displayAllBatchesSummary(allBatches);
          }
        }

        progressBar.classList.add("hidden");
        statusDiv.classList.add("hidden");

        alert(
          `Processing complete!\nTotal batches: ${allBatches.length}\nTotal stations stored: ${totalStored}`,
        );
      }

      function parseStationLine(line) {
        try {
          const equalParts = line.split("=");
          const mainPart = equalParts[0].trim();
          const commentPart = equalParts[1]
            ? equalParts.slice(1).join("=").trim()
            : "";

          const groups = mainPart.split(/\s+/);
          if (groups.length < 2) return null;

          const station = {
            id: groups[0],
            name: stationNames[groups[0]] || `Station ${groups[0]}`,
            raw: line,
            comment: commentPart,
            extras: parseCommentData(commentPart),
          };

          let i = 1;

          // Section 0: iRixhVV
          if (groups[i] && groups[i].length === 5) {
            const g = groups[i];
            station.iR = g[0];
            station.ix = g[1];
            station.h = g[2];
            station.VV = g.substring(3, 5);
            i++;
          }

          // Section 1: Nddff
          if (groups[i] && groups[i].length === 5) {
            const g = groups[i];
            station.N = g[0];
            station.dd = g.substring(1, 3);
            station.ff = g.substring(3, 5);
            station.cloudCover = codeTables.cloudAmount[station.N] || station.N;
            station.windDir =
              codeTables.windDir[station.dd] || `${parseInt(station.dd) * 10}¬∞`;
            let ff = parseInt(station.ff);
            station.windSpeed = ff >= 50 ? `${ff + 100}kn` : `${ff}kn`;
            i++;
          }

          // 1snTTT - Temperature
          if (groups[i] && groups[i].startsWith("1")) {
            const g = groups[i];
            const sign = g[1] === "0" ? 1 : -1;
            station.temp = ((sign * parseInt(g.substring(2, 5))) / 10).toFixed(
              1,
            );
            i++;
          }

          // 2snTdTdTd - Dew Point
          if (groups[i] && groups[i].startsWith("2")) {
            const g = groups[i];
            const sign = g[1] === "0" ? 1 : -1;
            station.dewPoint = (
              (sign * parseInt(g.substring(2, 5))) /
              10
            ).toFixed(1);
            i++;
          }

          // 4PPPP - Pressure
          if (groups[i] && groups[i].startsWith("4")) {
            station.pressureCode = groups[i];
            station.pressure = decodePressure(groups[i]) + " hPa";
            i++;
          }

          // 7wwW1W2 - Weather
          if (groups[i] && groups[i].startsWith("7")) {
            const g = groups[i];
            station.ww = g.substring(1, 3);
            station.W1 = g[3];
            station.W2 = g[4];
            station.weather =
              codeTables.presentWeather[station.ww] || station.ww;
            i++;
          }

          // 8NhCLCMCH - Clouds
          if (groups[i] && groups[i].startsWith("8")) {
            const g = groups[i];
            station.Nh = g[1];
            station.CL = g[2];
            station.CM = g[3];
            station.CH = g[4];
            i++;
          }

          // Section 3 (333)
          while (i < groups.length && !groups[i].startsWith("333")) i++;

          if (groups[i] === "333") {
            i++;
            if (groups[i] && groups[i].startsWith("1")) {
              const g = groups[i];
              const sign = g[1] === "0" ? 1 : -1;
              station.maxTemp = (
                (sign * parseInt(g.substring(2, 5))) /
                10
              ).toFixed(1);
              i++;
            }

            if (
              groups[i] &&
              (groups[i].startsWith("58") || groups[i].startsWith("59"))
            ) {
              const g = groups[i];
              const type = g.startsWith("58") ? "‚Üë" : "‚Üì";
              const amount = (parseInt(g.substring(2, 5)) / 10).toFixed(1);
              station.pressChange = `${type}${amount}`;
            }
          }

          // Visibility
          if (station.extras.visibility) {
            station.finalVisibility = `${station.extras.visibility}m`;
          } else if (station.VV) {
            const vvCode = station.VV;
            if (vvCode >= "90") {
              const visMap = {
                90: "<50m",
                91: "50m",
                92: "200m",
                93: "500m",
                94: "1km",
                95: "2km",
                96: "4km",
                97: "10km",
                98: "20km",
                99: "‚â•50km",
              };
              station.finalVisibility =
                visMap[vvCode] || `${parseInt(vvCode)}00m`;
            } else if (vvCode <= "50") {
              station.finalVisibility = `${(parseInt(vvCode) * 0.1).toFixed(1)}km`;
            } else {
              station.finalVisibility = `${parseInt(vvCode) - 50}km`;
            }
          }

          return station;
        } catch (e) {
          console.error("Error parsing station:", e);
          return null;
        }
      }

      function displayBatch(batch) {
        const dateKey = `${batch.header.obsDate}-${batch.month}-${batch.year}`;
        const gmtKey = batch.header.obsHour;

        // Update header
        document.getElementById("monthDisplay").textContent = new Date(
          2000,
          parseInt(batch.month) - 1,
        ).toLocaleString("default", { month: "long" });
        document.getElementById("obsDateDisplay").textContent = dateKey;
        document.getElementById("obsTimeDisplay").textContent =
          `${gmtKey}:00 GMT`;
        document.getElementById("windUnit").textContent =
          { 0: "Est (kn)", 1: "Anemo (kn)", 3: "Est (m/s)", 4: "Anemo (m/s)" }[
            batch.header.windIndicator
          ] || "Unknown";
        document.getElementById("totalStations").textContent =
          batch.stations.length;
        document.getElementById("batchCount").textContent = "1";
        document.getElementById("dateTimeInfo").classList.remove("hidden");

        // Display summary table
        const tbody = document.getElementById("summaryTableBody");
        tbody.innerHTML = "";

        batch.stations.forEach((station) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td class="text-slate-400">${dateKey}</td>
            <td><span class="gmt-badge">${gmtKey}:00</span></td>
            <td class="font-mono font-semibold text-blue-400">${station.id}</td>
            <td class="font-semibold text-white">${station.name}</td>
            <td>${station.temp || "-"}</td>
            <td>${station.extras.wb ? `<span class="wb-highlight">${station.extras.wb}</span>` : "-"}</td>
            <td>${station.extras.rh ? `<span class="rh-highlight">${station.extras.rh}%</span>` : "-"}</td>
            <td>${station.finalVisibility || "-"}</td>
            <td>${station.windDir || "-"} / ${station.windSpeed || "-"}</td>
            <td>${station.weather || "-"}</td>
            <td>${station.cloudCover || "-"}</td>
          `;
          tbody.appendChild(row);
        });

        document.getElementById("summarySection").classList.remove("hidden");

        // Display cards
        displayStations(batch.stations);
        document.getElementById("emptyState").classList.add("hidden");
      }

      function displayAllBatchesSummary(batches) {
        // Add a summary section for all batches
        const container = document.getElementById("resultsContainer");

        const summaryDiv = document.createElement("div");
        summaryDiv.className =
          "glass-panel rounded-xl p-4 mb-6 border-2 border-blue-500/50";
        summaryDiv.innerHTML = `
          <h3 class="text-lg font-bold text-white mb-3">All Batches Summary (${batches.length} total)</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
            ${batches
              .map(
                (b, i) => `
              <div class="bg-slate-800 rounded-lg p-3 border border-slate-700">
                <div class="flex justify-between items-center">
                  <span class="date-badge text-sm">${b.header.obsDate}-${b.month}-${b.year}</span>
                  <span class="gmt-badge text-xs">${b.header.obsHour}:00</span>
                </div>
                <p class="text-slate-400 text-sm mt-2">${b.stations.length} stations</p>
              </div>
            `,
              )
              .join("")}
          </div>
        `;

        container.insertBefore(summaryDiv, container.firstChild);
      }

      function displayStations(stations) {
        const container = document.getElementById("resultsContainer");
        // Keep the summary div if exists
        const summaryDiv = container.querySelector(".glass-panel.border-2");
        container.innerHTML = "";
        if (summaryDiv) container.appendChild(summaryDiv);

        stations.forEach((station, index) => {
          const card = document.createElement("div");
          card.className = "station-card rounded-xl p-6 animate-fade-in";
          card.style.animationDelay = `${index * 0.05}s`;

          const hasExtras =
            station.extras.rh || station.extras.wb || station.extras.visibility;

          card.innerHTML = `
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 pb-4 border-b border-slate-700">
              <div>
                <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                  ${station.name}
                  <span class="code-badge text-sm">${station.id}</span>
                </h2>
              </div>
              <div class="mt-2 md:mt-0 flex gap-2">
                ${station.extras.rh ? `<span class="rh-highlight text-sm">RH: ${station.extras.rh}%</span>` : ""}
                ${station.extras.wb ? `<span class="wb-highlight text-sm">WB: ${station.extras.wb}¬∞C</span>` : ""}
              </div>
            </div>

            <div class="param-grid">
              <div class="param-item">
                <div class="param-label">Temperature</div>
                <div class="param-value text-orange-400">${station.temp ? station.temp + "¬∞C" : "N/A"}</div>
                ${station.maxTemp ? `<div class="text-xs text-slate-400 mt-1">Max: ${station.maxTemp}¬∞C</div>` : ""}
              </div>

              <div class="param-item">
                <div class="param-label">Wet Bulb</div>
                <div class="param-value ${station.extras.wb ? "text-orange-300" : "text-slate-500"}">
                  ${station.extras.wb ? station.extras.wb + "¬∞C" : "N/A"}
                </div>
              </div>

              <div class="param-item">
                <div class="param-label">Relative Humidity</div>
                <div class="param-value ${station.extras.rh ? "text-green-400" : "text-slate-500"}">
                  ${station.extras.rh ? station.extras.rh + "%" : "N/A"}
                </div>
              </div>

              <div class="param-item">
                <div class="param-label">Pressure</div>
                <div class="param-value text-purple-400">${station.pressure || "N/A"}</div>
                <div class="text-xs text-slate-400">${station.pressureCode || ""}</div>
              </div>

              <div class="param-item">
                <div class="param-label">Wind</div>
                <div class="param-value">${station.windDir || "N/A"} @ ${station.windSpeed || "N/A"}</div>
              </div>

              <div class="param-item">
                <div class="param-label">Visibility</div>
                <div class="param-value text-purple-300">${station.finalVisibility || "N/A"}</div>
              </div>

              <div class="param-item">
                <div class="param-label">Cloud Cover</div>
                <div class="param-value">${station.cloudCover || "N/A"}</div>
              </div>

              <div class="param-item">
                <div class="param-label">Weather</div>
                <div class="param-value text-sm">${station.weather || "N/A"}</div>
              </div>
            </div>

            <div class="mt-4 pt-4 border-t border-slate-700">
              <button onclick="this.nextElementSibling.classList.toggle('hidden')" class="text-xs text-slate-500 hover:text-slate-300">
                Toggle Raw Data
              </button>
              <div class="hidden mt-2 p-3 bg-slate-900 rounded font-mono text-xs text-slate-400 overflow-x-auto">
                ${station.raw}
              </div>
            </div>
          `;

          container.appendChild(card);
        });
      }

      // Database View Functions
      function showDatabaseView() {
        document.getElementById("databaseView").classList.remove("hidden");
        document.getElementById("currentResults").classList.add("hidden");
        document.getElementById("emptyState").classList.add("hidden");
        updateAvailableDatesList();
      }

      function updateAvailableDatesList() {
        const container = document.getElementById("availableDatesList");
        const dates = Object.keys(synopDatabase).sort();

        if (dates.length === 0) {
          container.innerHTML =
            '<span class="text-slate-500">No data available</span>';
          return;
        }

        container.innerHTML = dates
          .map(
            (date) => `
          <button onclick="document.getElementById('selectDate').value='${date}'; loadDateData()" 
                  class="date-badge hover:bg-green-500/30 cursor-pointer transition-all">
            ${date}
          </button>
        `,
          )
          .join("");
      }

      function loadDateData() {
        const selectedDate = document.getElementById("selectDate").value.trim();
        const selectedGMT = document.getElementById("selectGMT").value;
        const display = document.getElementById("storedDataDisplay");

        if (!selectedDate) {
          updateAvailableDatesList();
          return;
        }

        if (!synopDatabase[selectedDate]) {
          display.innerHTML = `<p class="text-red-400 text-center py-8">No data found for ${selectedDate}</p>`;
          return;
        }

        let html = "";
        const gmts =
          selectedGMT === "all"
            ? Object.keys(synopDatabase[selectedDate]).sort()
            : [selectedGMT];

        gmts.forEach((gmt) => {
          if (!synopDatabase[selectedDate][gmt]) return;

          const data = synopDatabase[selectedDate][gmt];
          html += `
            <div class="glass-panel rounded-xl p-4 mb-4 border border-blue-500/30">
              <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-white">
                  <span class="date-badge mr-2">${selectedDate}</span>
                  <span class="gmt-badge">${gmt}:00 GMT</span>
                </h3>
                <span class="text-slate-400 text-sm">${data.stations.length} stations</span>
              </div>
              <div class="overflow-x-auto">
                <table class="summary-table">
                  <thead>
                    <tr>
                      <th>Station</th>
                      <th>Temp</th>
                      <th>Max</th>
                      <th>WB</th>
                      <th>RH</th>
                      <th>Pressure</th>
                      <th>Visibility</th>
                      <th>Wind</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${data.stations
                      .map(
                        (s) => `
                      <tr>
                        <td class="font-semibold text-white">${s.name}</td>
                        <td>${s.temp || "-"}¬∞C</td>
                        <td>${s.maxTemp || "-"}¬∞C</td>
                        <td>${s.extras.wb || "-"}¬∞C</td>
                        <td>${s.extras.rh ? s.extras.rh + "%" : "-"}</td>
                        <td>${s.pressure || "-"}</td>
                        <td>${s.finalVisibility || "-"}</td>
                        <td>${s.windDir || "-"} ${s.windSpeed || "-"}</td>
                      </tr>
                    `,
                      )
                      .join("")}
                  </tbody>
                </table>
              </div>
            </div>
          `;
        });

        display.innerHTML =
          html ||
          '<p class="text-slate-400 text-center">No data for selected GMT</p>';
      }

      function compareDates() {
        const fromDate = document.getElementById("fromDate").value.trim();
        const toDate = document.getElementById("toDate").value.trim();

        if (!fromDate || !toDate) {
          alert("Please enter both dates in DD-MM-YYYY format!");
          return;
        }

        const display = document.getElementById("storedDataDisplay");
        const allDates = Object.keys(synopDatabase).sort();

        // Filter dates in range
        const filteredDates = allDates.filter((d) => {
          // Simple string comparison works for DD-MM-YYYY format if years are same
          // For better comparison, convert to Date objects
          const [d1, m1, y1] = d.split("-").map(Number);
          const [d2, m2, y2] = fromDate.split("-").map(Number);
          const [d3, m3, y3] = toDate.split("-").map(Number);

          const dateObj = new Date(y1, m1 - 1, d1);
          const fromObj = new Date(y2, m2 - 1, d2);
          const toObj = new Date(y3, m3 - 1, d3);

          return dateObj >= fromObj && dateObj <= toObj;
        });

        if (filteredDates.length === 0) {
          display.innerHTML =
            '<p class="text-red-400 text-center">No data found in this date range</p>';
          return;
        }

        let html = `<h3 class="text-xl font-bold text-white mb-4">Comparison: ${fromDate} to ${toDate}</h3>
                    <p class="text-green-400 mb-4">Found ${filteredDates.length} dates</p>`;

        filteredDates.forEach((date) => {
          const gmts = Object.keys(synopDatabase[date]);
          const totalStations = gmts.reduce(
            (sum, g) => sum + synopDatabase[date][g].stations.length,
            0,
          );

          html += `
            <div class="glass-panel rounded-lg p-4 mb-4 border border-slate-700">
              <h4 class="date-badge inline-block mb-2">${date}</h4>
              <p class="text-slate-300 text-sm">Total records: ${totalStations} across ${gmts.length} GMTs</p>
              <div class="flex gap-2 mt-2 flex-wrap">
                ${gmts
                  .map((g) => {
                    const s = synopDatabase[date][g].stations;
                    const avgTemp =
                      s
                        .filter((x) => x.temp)
                        .reduce((a, b) => a + parseFloat(b.temp), 0) /
                      s.filter((x) => x.temp).length;
                    return `
                    <div class="bg-slate-800 rounded p-2 text-center min-w-[80px]">
                      <span class="gmt-badge text-xs">${g}:00</span>
                      <p class="text-slate-300 text-xs mt-1">${s.length} stns</p>
                      ${avgTemp ? `<p class="text-xs text-orange-400">Avg: ${avgTemp.toFixed(1)}¬∞C</p>` : ""}
                    </div>
                  `;
                  })
                  .join("")}
              </div>
            </div>
          `;
        });

        display.innerHTML = html;
      }

      function show0312Table() {
        const tbody = document.getElementById("tbody0312");
        tbody.innerHTML = "";

        const allDates = Object.keys(synopDatabase).sort();
        let count = 0;

        allDates.forEach((date) => {
          ["03", "12"].forEach((gmt) => {
            if (synopDatabase[date][gmt]) {
              const data = synopDatabase[date][gmt];
              data.stations.forEach((s) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                  <td class="text-slate-400">${date}</td>
                  <td><span class="gmt-badge">${gmt}:00</span></td>
                  <td class="font-semibold text-white">${s.name}</td>
                  <td>${s.temp || "-"}¬∞C</td>
                  <td>${s.maxTemp || "-"}¬∞C</td>
                  <td>${s.extras.wb || "-"}¬∞C</td>
                  <td>${s.extras.rh ? s.extras.rh + "%" : "-"}</td>
                  <td class="text-purple-400 font-semibold">${s.pressure || "-"}</td>
                  <td>${s.finalVisibility || "-"}</td>
                  <td>${s.windDir || "-"} ${s.windSpeed || "-"}</td>
                  <td>${s.weather || "-"}</td>
                `;
                tbody.appendChild(row);
                count++;
              });
            }
          });
        });

        if (count === 0) {
          tbody.innerHTML =
            '<tr><td colspan="11" class="text-center text-slate-400 py-8">No 03 or 12 GMT data found in database</td></tr>';
        }

        document.getElementById("special0312Table").classList.remove("hidden");
        document
          .getElementById("special0312Table")
          .scrollIntoView({ behavior: "smooth" });
      }

      function exportDatabase() {
        const dataStr = JSON.stringify(synopDatabase, null, 2);
        const dataBlob = new Blob([dataStr], { type: "application/json" });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement("a");
        link.href = url;
        link.download = `synop_database_${new Date().toISOString().split("T")[0]}.json`;
        link.click();
        URL.revokeObjectURL(url);
      }

      // Initialize
      document.addEventListener("DOMContentLoaded", () => {
        updateAvailableDatesList();
      });
    </script>
  </body>
</html>
